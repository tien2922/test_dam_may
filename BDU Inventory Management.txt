# BDU Inventory Management â€“ 3â€‘Tier App (React + FastAPI + MySQL/RDS)

> TÃ i liá»‡u take note tá»•ng há»£p: cháº¡y **VS Code trÆ°á»›c** (localhost), rá»“i **Docker hÃ³a**, sau Ä‘Ã³ **deploy AWS (EC2 + RDS)**. Bao gá»“m cáº£ bá»™ khung 3â€‘tier máº«u vÃ  phiÃªn báº£n **BDU Inventory**.

---

## ğŸ“¦ Táº£i bá»™ source

* React + FastAPI (khung 3â€‘tier) **(dev trÆ°á»›c, rá»“i deploy)**
  â¬‡ï¸ `aws-3tier-react-fastapi.zip` â€“ [Download](sandbox:/mnt/data/aws-3tier-react-fastapi.zip)
* React + FastAPI (khung 3â€‘tier) **+ Docker hÃ³a Ä‘áº§y Ä‘á»§**
  â¬‡ï¸ `aws-3tier-react-fastapi-dockerized.zip` â€“ [Download](sandbox:/mnt/data/aws-3tier-react-fastapi-dockerized.zip)
* **BDU Inventory Management** (React + FastAPI + MySQL/RDS)
  â¬‡ï¸ `bdu-inventory-react-fastapi.zip` â€“ [Download](sandbox:/mnt/data/bdu-inventory-react-fastapi.zip)

---

## ğŸ§± Kiáº¿n trÃºc chung (3â€‘tier)

```
Browser â‡„ Frontend (React/Vite, Nginx khi build) â‡„ Backend (FastAPI) â‡„ MySQL (Local Docker / Amazon RDS)
```

---

## ğŸš€ Cháº¡y LOCAL trÆ°á»›c báº±ng VS Code (BDU Inventory)

**1) MySQL (Docker cho dev):**

```bash
cd backend
docker compose up -d
mysql -h127.0.0.1 -P3306 -uroot -psecret <<'SQL'
CREATE DATABASE IF NOT EXISTS bdu_inventory;
USE bdu_inventory;
SOURCE ../sql/schema.sql;
SQL
```

**2) Backend (FastAPI):**

```bash
cd backend
python -m venv .venv
# Windows: .venv\Scripts\activate
source .venv/bin/activate
pip install -r requirements.txt
cp .env.example .env
# DB_URL=mysql+aiomysql://root:secret@127.0.0.1:3306/bdu_inventory
uvicorn app.main:app --reload --port 8080
# http://localhost:8080/docs
```

**3) Frontend (React + Vite):**

```bash
cd frontend
npm install
cp .env.example .env
# VITE_API_BASE_URL=http://localhost:8080
npm run dev    # http://localhost:5173
```

> Má»¥c tiÃªu: verify UI CRUD + healthcheck, DB cáº­p nháº­t Ä‘Ãºng.

---

## ğŸ³ Docker hÃ³a (Dev hotâ€‘reload)

**Cháº¡y toÃ n bá»™ (FE + BE + DB) vá»›i hotâ€‘reload:**

```bash
docker compose -f docker-compose.dev.yml up --build
# FE: http://localhost:5173 | BE: http://localhost:8080
```

* FE mount code â†’ `npm run dev` (Vite HMR)
* BE mount code â†’ `uvicorn --reload`
* DB: `mysql:8.0` container (root/secret)

**Build kiá»ƒu â€œprodâ€ (khÃ´ng hotâ€‘reload, dÃ¹ng RDS):**

```bash
export DB_URL="mysql+aiomysql://<user>:<pass>@<rds-endpoint>:3306/bdu_inventory"
export CORS_ORIGINS="https://your-frontend-domain"
docker compose build
docker compose up -d
# FE: 80 (Nginx) | BE: 8080
```

---

## â˜ï¸ Deploy AWS (tÃ³m táº¯t)

1. **RDS MySQL**: MySQL 8.0, táº¡o DB `bdu_inventory` vÃ  cháº¡y `sql/schema.sql`.
   SG RDS: cho phÃ©p inbound 3306 **tá»« SG cá»§a Backend EC2**.
2. **Backend EC2 (Ubuntu 22.04)**:

   * CÃ i Python 3.11, `python3-venv`, `pip`, clone source.
   * `pip install -r requirements.txt`, táº¡o `.env`:

     ```ini
     APP_PORT=8080
     DB_URL=mysql+aiomysql://<user>:<pass>@<rds-endpoint>:3306/bdu_inventory
     CORS_ORIGINS=https://<frontend-domain>
     ```
   * Cháº¡y `gunicorn -k uvicorn.workers.UvicornWorker -w 2 -b 0.0.0.0:8080 app.main:app`
     (hoáº·c dÃ¹ng Docker Compose prod nhÆ° trÃªn).
   * SG Backend: má»Ÿ **8080** tá»« FE EC2 (hoáº·c táº¡m IP cá»§a báº¡n khi test).
3. **Frontend EC2 (Ubuntu 22.04)**:

   * CÃ i Node/NPM + Nginx.
   * `npm ci && npm run build` â†’ copy `dist/` vÃ o `/var/www/html`.
   * Sá»­a `.env` FE: `VITE_API_BASE_URL=https://<backend-host>:8080` rá»“i build.
   * SG Frontend: má»Ÿ **80/443**. DÃ¹ng Certbot náº¿u cáº§n HTTPS.

> Tip: cÃ³ thá»ƒ deploy cáº£ FE+BE báº±ng Docker Compose trÃªn tá»«ng EC2 Ä‘á»ƒ tá»‘i giáº£n cÃ i Ä‘áº·t.

---

## ğŸ§ª API endpoints (BDU Inventory)

**Products**

* `GET /api/products`
* `POST /api/products`
  Body: `{ "sku":"P-001", "name":"BDU Pen", "unit_price":0.5 }`
* `PUT /api/products/{id}`
  Body nhÆ° trÃªn
* `DELETE /api/products/{id}`

**Suppliers**

* `GET /api/suppliers`
* `POST /api/suppliers`
  Body: `{ "name":"BDU Supplies", "email":"...", "phone":"..." }`
* `PUT /api/suppliers/{id}`
* `DELETE /api/suppliers/{id}`

**Stock Moves**

* `GET /api/stock_moves`
* `POST /api/stock_moves`
  Body: `{ "product_id":1, "quantity":10, "move_type":"IN", "note":"initial" }`

  > `move_type` = `IN` | `OUT`; cháº·n OUT > stock hiá»‡n táº¡i.

**Health**

* `GET /health` â†’ `{ "status":"ok" }`

---

## ğŸ—‚ï¸ Cáº¥u trÃºc thÆ° má»¥c (BDU Inventory)

```
root/
 â”œâ”€ frontend/              # React (Vite)
 â”‚   â”œâ”€ .env.example       # VITE_API_BASE_URL
 â”‚   â”œâ”€ src/               # App.jsx (Products, Suppliers, Stock)
 â”‚   â”œâ”€ Dockerfile         # Build -> Nginx serve
 â”‚   â””â”€ nginx.conf
 â”œâ”€ backend/               # FastAPI
 â”‚   â”œâ”€ app/
 â”‚   â”‚   â”œâ”€ main.py        # Routes
 â”‚   â”‚   â”œâ”€ models.py      # Product, Supplier, StockMove
 â”‚   â”‚   â”œâ”€ database.py    # Async engine + session
 â”‚   â”‚   â””â”€ crud.py, schemas.py
 â”‚   â”œâ”€ requirements.txt
 â”‚   â”œâ”€ .env.example       # APP_PORT, DB_URL, CORS_ORIGINS
 â”‚   â”œâ”€ Dockerfile
 â”‚   â””â”€ docker-compose.yml # MySQL local for dev
 â”œâ”€ sql/
 â”‚   â””â”€ schema.sql         # Táº¡o báº£ng + seed data
 â”œâ”€ docker-compose.dev.yml # Dev: FE+BE hot reload + MySQL
 â”œâ”€ docker-compose.yml     # Prod: FE(Nginx)+BE(Uvicorn/Gunicorn)
 â””â”€ .vscode/
     â”œâ”€ launch.json        # VS Code run FE/BE khÃ´ng cáº§n Docker
     â””â”€ tasks.json         # pip install / npm install / compose
```

---

## âš™ï¸ Biáº¿n mÃ´i trÆ°á»ng (tham kháº£o)

**Backend** `.env`

```
APP_PORT=8080
DB_URL=mysql+aiomysql://root:secret@127.0.0.1:3306/bdu_inventory
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
```

**Frontend** `.env`

```
VITE_API_BASE_URL=http://localhost:8080
```

---

## ğŸ” Gá»£i Ã½ báº£o máº­t & máº¡ng (AWS)

* RDS SG: chá»‰ cho phÃ©p 3306 tá»« SG cá»§a Backend EC2 (khÃ´ng má»Ÿ public).
* Backend SG: má»Ÿ 8080 **chá»‰** cho Frontend EC2 (hoáº·c ALB), trÃ¡nh 0.0.0.0/0.
* DÃ¹ng HTTPS (ALB hoáº·c Nginx + Certbot) cho cáº£ frontend vÃ  backend khi public.
* TÃ¡ch **Network ACL**/Subnets private cho RDS, public cho EC2 (náº¿u cáº§n).

---

## â• Má»Ÿ rá»™ng Ä‘á» xuáº¥t

* **Auth (JWT)** + phÃ¢n quyá»n (Admin/Kho/Viewer)
* **Purchase Orders** & **Sales Orders**; bÃ¡o cÃ¡o tá»“n & lá»‹ch sá»­ giao dá»‹ch
* **Import/Export CSV/Excel**, **Audit logs**
* **CI/CD** (GitHub Actions â†’ ECR â†’ EC2)
* **Terraform** dá»±ng EC2, RDS, SG theo chuáº©n BDU

> Cáº§n thÃªm module nÃ o, ghi chÃº táº¡i Ä‘Ã¢y Ä‘á»ƒ mÃ¬nh bá»• sung vÃ o codebase.
